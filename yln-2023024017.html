<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>用户研究作业2023024017</title>
    <script src="https://unpkg.com/jspsych@7.3.4"></script>
    <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.3"></script>
    <link rel="stylesheet" href="https://unpkg.com/jspsych@7.3.4/css/jspsych.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="experiment-container">
        <script>
            let jsPsych = initJsPsych();

            // 介绍说明
            let instruction = {
                type: jsPsychHtmlKeyboardResponse,
                stimulus: `
                <p>在实验中，屏幕中央会呈现一个面孔</p>
                <p>如果呈现的是积极面孔,请尽快按【f】键</p>
                <p>如果呈现的是消极面孔,请尽快按【j】键</p>
                <p>按任意键开始实验</p>
                `,
                post_trial_gap: 500
            };

            // 定义积极和消极试次
            let positive_trial = {
                type: jsPsychHtmlKeyboardResponse,
                stimulus: `<img src="./img/positive.png">`,
                choices: ['f', 'j'],
                data: { face: 'positive' },
                post_trial_gap: 500
            };

            let pessimistic_trial = {
                type: jsPsychHtmlKeyboardResponse,
                stimulus: `<img src="./img/pessimistic.png">`,
                choices: ['f', 'j'],
                data: { face: 'pessimistic' },
                post_trial_gap: 500
            };

            // 生成50个随机试次（积极和消极随机）
            let generateTrials = () => {
                let trials = [];
                for (let i = 0; i < 50; i++) {
                    trials.push(Math.random() < 0.5 ? positive_trial : pessimistic_trial);
                }
                return trials;
            };

            // 休息屏幕
            let break_screen = {
                type: jsPsychHtmlKeyboardResponse,
                stimulus: `<p>休息2分钟。请稍候...</p>`,
                trial_duration: 120000,
                post_trial_gap: 500
            };

            // 继续实验屏幕
            let continue_screen = {
                type: jsPsychHtmlKeyboardResponse,
                stimulus: `<p>休息结束。按任意键继续实验。</p>`,
                post_trial_gap: 500
            };

            // 实验时间轴
            let timeline = [instruction];

            // 添加第一组50个试次，然后休息，再添加第二组50个试次
            timeline = timeline.concat(generateTrials());
            timeline.push(break_screen);
            timeline.push(continue_screen);
            timeline = timeline.concat(generateTrials());

            // 启动实验
            jsPsych.run(timeline);
        </script>
    </div>
</body>
</html>
